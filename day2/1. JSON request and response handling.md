# JSON Request/Response Handling in Flask

When building modern web applications and APIs, JSON (JavaScript Object Notation) is the most common format for communication between client and server. Flask, a lightweight Python web framework, makes working with JSON requests and responses simple and intuitive.

In this post, we’ll walk through how to handle JSON in Flask—covering both incoming requests and outgoing responses—with clear examples.

---

## Why JSON?

JSON is human-readable, lightweight, and supported across platforms and programming languages. It’s the backbone of RESTful APIs and microservices because of its simplicity and interoperability.

---

## Setting Up a Basic Flask Application

Before diving into JSON handling, let’s set up a simple Flask app.

```python
from flask import Flask, request, jsonify

app = Flask(__name__)
```

---

## Handling JSON Requests

When a client sends data in JSON format (usually via POST or PUT requests), Flask provides utilities to parse it.

### Example: Adding a User

```python
@app.route('/add-user', methods=['POST'])
def add_user():
    data = request.get_json()   # Parse JSON from request body

    name = data.get('name')
    email = data.get('email')

    if not name or not email:
        return jsonify({"error": "Name and email are required"}), 400

    return jsonify({
        "message": "User added successfully",
        "user": {
            "name": name,
            "email": email
        }
    }), 201
```

### Explanation:

- `request.get_json()` extracts JSON payload from the request.
- Input is validated before proceeding.
- A success response is sent back with a `201 Created` status.

Test with **cURL**:

```bash
curl -X POST http://127.0.0.1:5000/add-user \
     -H "Content-Type: application/json" \
     -d '{"name": "Vinod", "email": "vinod@vinod.co"}'
```

---

## Returning JSON Responses

Flask makes sending JSON back to the client easy using the `jsonify` helper.

### Example: Fetching All Users

```python
@app.route('/get-users', methods=['GET'])
def get_users():
    users = [
        {"id": 1, "name": "Vinod", "email": "vinod@vinod.co"},
        {"id": 2, "name": "Shyam", "email": "shyam@xmpl.com"}
    ]
    return jsonify(users)
```

Here, `jsonify`:

- Converts Python dictionaries/lists into JSON.
- Automatically sets the correct `Content-Type: application/json` header.

---

## Error Handling with JSON

A well-designed API should send consistent error messages in JSON format. Instead of raw HTML error pages, JSON responses are machine-readable and easier to consume.

### Example 1: Validation Error

```python
@app.route('/register', methods=['POST'])
def register():
    data = request.get_json()
    email = data.get('email')

    if not email or "@" not in email:
        return jsonify({"error": "Invalid email address"}), 400

    return jsonify({"message": "Registration successful"}), 201
```

### Example 2: Not Found Error

```python
@app.route('/get-user/<int:user_id>', methods=['GET'])
def get_user(user_id):
    users = {
        1: {"name": "Vinod", "email": "vinod@vinod.co"},
        2: {"name": "Shyam", "email": "shyam@xmpl.com"}
    }

    user = users.get(user_id)
    if not user:
        return jsonify({"error": "User not found"}), 404

    return jsonify(user)
```

---

## Tips & Best Practices

1. **Validate Input:** Never trust client data. Validate JSON payloads using libraries like [Marshmallow](https://marshmallow.readthedocs.io/) or [pydantic](https://docs.pydantic.dev/).
2. **Consistent Response Format:** Define a standard response structure for success and error cases.
3. **Use Status Codes:** Return appropriate HTTP status codes (`200`, `201`, `400`, `404`, etc.).
4. **Content-Type Matters:** Ensure clients set `Content-Type: application/json` in request headers for JSON requests.

---

## Running the App

Save the code in a file, say `app.py`, and run:

```bash
flask run
```

Test with **cURL**:

```bash
curl -X GET http://127.0.0.1:5000/get-users
```

Response:

```json
[
  { "id": 1, "name": "Vinod", "email": "vinod@vinod.co" },
  { "id": 2, "name": "Shyam", "email": "shyam@xmpl.com" }
]
```

---

## Conclusion

Handling JSON in Flask is straightforward with `request.get_json()` for incoming data and `jsonify()` for outgoing responses. By adding input validation, proper error handling, and consistent response structures, you can build robust and reliable APIs that integrate seamlessly with modern applications.
